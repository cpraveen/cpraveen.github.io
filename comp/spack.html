<!DOCTYPE html>
<html>

<head>
<meta name="keywords" content="CFD, FEM, PDE, TIFR, TIFRCAM">
<meta name="description" content="Homepage of Praveen Chandrashekar">
<meta name="author" content="Praveen Chandrashekar">
<title>Homepage of Praveen Chandrashekar</title>
<base href="http://cpraveen.github.io">
<meta name="google-site-verification" content="vQAVognXBtgyMZ4p32RBsnPK7MpBeyGXWOnK7ywnCX4" />
<style>
html,body{
    height: 100%;
    margin: 0;
    padding: 0;
}
body {
   font-family:Verdana,sans-serif;
   font-size:100%;
}
header {
    width:20%;
    height:100%;
    float:left;
}
nav {
    line-height:25px;
    background-color:#beeeee;
    width:20%;
    height:100%;
    padding:25px;	      
    position:fixed;
}
section {
    width:70%;
    float:right;
    padding:25px;	 	 
}
footer {
    background-color:black;
    color:white;
    clear:both;
    text-align:center;
    padding:5px;	 	 
    font-size: 0.5em;
}
h1,h2,h3 {
   font-family: Georgia,serif;
}
h1 {
    font-size: 1.6em;
    text-align: center;
}

h2 {
    font-size: 1.4em;
}

h3 {
    font-size: 1.2em;
}

p,li {
    font-size: 0.875em;
    line-height: 150%;
}
code {
    font-size: 1.2em;
    color: blue;
}
pre {
    font-size: 1.2em;
    color: blue;
}
a:link    {color:green; background-color:transparent; text-decoration:none}
a:visited {color:green; background-color:transparent; text-decoration:none}
a:hover   {color:red; background-color:transparent; text-decoration:underline}
a:active  {color:yellow; background-color:transparent; text-decoration:underline}

a.contact_link { 
   font-size: 0.75em;
}
a.contact_link:hover { 
   color:red; 
   background-color:transparent; 
   text-decoration:none;
}

</style>
<link rel="stylesheet" href="https://cpraveen.github.io/css/academicons.css"/>
<link href='https://fonts.googleapis.com/css?family=Merriweather:300%7CRaleway%7COpen+Sans' rel='stylesheet' type='text/css'>
<script src="https://use.fontawesome.com/916e4344cd.js"></script>
</head>

<body>

<nav>
   <h1>Praveen Chandrashekar</h1>

   <p>
   <a href="index.html">Home</a><br>
   <a href="people.html">People</a><br>
   <a href="codes.html">Codes</a><br>
   <a href="talks.html">Talks</a><br>
   <a href="teaching/index.html">Teaching</a><br>
   <a href="pub.html">Publications</a><br>
   <a href="forstudents.html">For students</a><br>
   <a href="localinfo.html">Around CAM</a><br>
   <a href="cal.html">Calendar</a><br>
   <a href="contact.html">Contact</a>
   </p>

<p style="text-align:center">

<a class="contact_link" href="https://twitter.com/cfdlab">
<span class="fa-stack fa-lg">
  <i class="fa fa-square-o fa-stack-2x"></i>
  <i class="fa fa-twitter fa-stack-1x"></i>
</span>
</a>

<a class="contact_link" href="https://github.com/cpraveen">
<span class="fa-stack fa-lg">
  <i class="fa fa-square-o fa-stack-2x"></i>
  <i class="fa fa-github fa-stack-1x"></i>
</span>
</a>

<a class="contact_link" href="https://gitlab.com/cpraveen">
<span class="fa-stack fa-lg">
  <i class="fa fa-square-o fa-stack-2x"></i>
  <i class="fa fa-gitlab fa-stack-1x"></i>
</span>
</a>

<a class="contact_link" href="https://bitbucket.org/cpraveen">
<span class="fa-stack fa-lg">
  <i class="fa fa-square-o fa-stack-2x"></i>
  <i class="fa fa-bitbucket fa-stack-1x"></i>
</span>
</a>

<a class="contact_link" href="https://www.youtube.com/channel/UC0kuy9roaaK5z5II9_6QNcg">
<span class="fa-stack fa-lg">
  <i class="fa fa-square-o fa-stack-2x"></i>
  <i class="fa fa-youtube fa-stack-1x"></i>
</span>
</a>

<a class="contact_link" href="http://arxiv.org/a/chandrashekar_p_1">
<span class="fa-stack fa-lg">
  <i class="fa fa-square-o fa-stack-2x"></i>
  <i class="ai ai-arxiv fa-stack-1x"></i>
</span>
</a>

<a class="contact_link" href="https://www.researchgate.net/profile/Praveen_Chandrashekar">
<span class="fa-stack fa-lg">
  <i class="fa fa-square-o fa-stack-2x"></i>
  <i class="ai ai-researchgate fa-stack-1x"></i>
</span>
</a>

<a class="contact_link" href="https://scholar.google.co.in/citations?user=9Mb6H7EAAAAJ">
<span class="fa-stack fa-lg">
  <i class="fa fa-square-o fa-stack-2x"></i>
  <i class="ai ai-google-scholar fa-stack-1x"></i>
</span>
</a>

<a class="contact_link" href="https://orcid.org/0000-0003-1903-4107">
<span class="fa-stack fa-lg">
  <i class="fa fa-square-o fa-stack-2x"></i>
  <i class="ai ai-orcid fa-stack-1x"></i>
</span>
</a>

<a class="contact_link" href="https://in.linkedin.com/pub/praveen-c/a/8b4/a2b">
<span class="fa-stack fa-lg">
  <i class="fa fa-square-o fa-stack-2x"></i>
  <i class="fa fa-linkedin fa-stack-1x"></i>
</span>
</a>

</p>

<script>
  (function() {
    var cx = '016958002023897541386:evkdaywutnc';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

</nav>


<section>
<h1>Spack</h1>

<p>
<a href="https://spack.readthedocs.io">Spack</a> is a package manager which is very useful to install scientific software.
</p>

<h2>Preparing a Linux system</h2>

<p>
We will install the gcc and gfortran compilers from the system package manager.  Dont install anything else since they will be installed using Spack. There are some instructions for <a href="comp/suse.html">OpenSUSE</a> and <a href="comp/debian.html">Debian</a>. Since Spack installs its own MPI library, it is best to uninstall any MPI you may have installed from your system package manager, since having multiple MPI around can cause problems.
</p>

<h2>Preparing a Mac system</h2>

<ul>

<li>Make sure you have latest command line tools (XCode is not required).</li>

<li>Install gcc from Homebrew which also provides the gfortran compiler. See <a href="comp/brew.html">here</a>.</li>


</ul>

<h2>Install Spack</h2>

<p>
We will install Spack into SPACK_ROOT directory.
</p>

<pre>
export SPACK_ROOT=/path/to/spack
</pre>

<p>
Now get Spack
</p>

<pre>
git clone https://github.com/spack/spack.git $SPACK_ROOT
</pre>

<p>
You can add following lines to your .bashrc or .profile file
</p>

<pre>
export SPACK_ROOT=/path/to/spack
. ${SPACK_ROOT}/share/spack/setup-env.sh
</pre>

<p>
Here are some useful Spack commands
</p>

<pre>
spack list intel          -- search package names containing intel
spack info gcc            -- show information for package gcc
spack find                -- shows installed packages
spack compilers           -- show available compilers
spack location -i openmpi -- show location of openmpi
</pre>

<p>Setup compilers by running</p>

<pre>
spack compiler find
</pre>

<p>
which creates the file compilers.yaml inside <code>$HOME/.spack/darwin</code> directory. Edit it if needed.
</p>

<p>
On Mac, use clang from Apple command line tools and gfortran from Homebrew. My file <code>$HOME/.spack/darwin/compilers.yaml</code> looks like this
</p>

<pre>
compilers:
- compiler:
    environment: {}
    extra_rpaths: []
    flags: {}
    modules: []
    operating_system: highsierra
    paths:
      cc: /usr/bin/clang
      cxx: /usr/bin/clang++
      f77: /usr/local/bin/gfortran
      fc: /usr/local/bin/gfortran
    spec: clang@9.0.0-apple
    target: x86_64
</pre>

<p>On Linux, use the gcc and gfortran from your system.</p>


<p>Set some package variants in <code>$HOME/.spack/darwin/packages.yaml</code> file like this</p>

<pre>
packages:
   hdf5:
      variants: +fortran +cxx +hl
   petsc:
      variants: +mumps +suite-sparse
   cgns:
      variants: +fortran
   trilinos:
      variants: +rol
   all:
      providers:
         mpi: [mpich]
</pre>

<p>
By default, Spack uses openmpi but you can select mpich as above. If you want to use openmpi, then change above line from mpich to openmpi or just dont specify the mpi provider.
</p>

<h2>Install softwares</h2>

<p>
I install deal.II and its dependencies which provides all the softwares that I need for my work. Since I like to compile deal.II myself, I will install only dependencies. But first check that all variants you need are correct by running
</p>

<pre>
spack spec dealii
spack spec -I dealii # -I shows already installed dependents
</pre>

<p>
If this is ok, then we install
</p>

<pre>
spack install -j4 --fail-fast --only dependencies dealii
</pre>

<p>
The flag <code>-j4</code> means that four processes will be used while compiling; increase this if you have more cores on your computer. If you primarily use Petsc and Metis, and dont need other stuff, then do
</p>

<pre>
spack spec petsc
spack install -j4 --fail-fast petsc
</pre>

<p>
Now create a Spack view by running the script spack_view.sh which will install symlinks into SPACK_VIEW directory.
</p>

<pre>
export SPACK_VIEW=/path/to/spack/view # Add to .bashrc or .profile file
sh /path/to/spack_view.sh /path/to/spack/view/dir
</pre>

<p>
If the SPACK_VIEW directory is in not in your home directory, then set ownership, e.g.,
</p>

<pre>
sudo mkdir $SPACK_VIEW
sudo chown praveen:users $SPACK_VIEW
</pre>

<p>
and then run the spack_view.sh script. This is useful on a Linux computer where I want to install the software for all users.
</p>

<p>
Here is a sample <a href="https://raw.githubusercontent.com/cpraveen/cfdlab/master/bin/spack_view.sh">spack_view.sh</a> script which you can edit for your needs. If you use mpich, then change openmpi to mpich in the script file.
</p>

<p>
You can set some variables in your .bashrc or .profile file
</p>

<pre>
export PETSC_DIR=$SPACK_VIEW
export SLEPC_DIR=$SPACK_VIEW
export METIS_DIR=$SPACK_VIEW
export HDF5_DIR=$SPACK_VIEW
export PATH=$SPACK_VIEW/bin:$PATH
</pre>

<p>
which can be used in your makefiles for compiling your applications.
</p>

<h2>Upgrading</h2>

<p>
When I want to upgrade, I usually reinstall everything from scratch.
</p>

<pre>
cd $SPACK_ROOT
git pull
</pre>

<p>
Update your compilers.yaml and packages.yaml files if needed. Verify that you get all package variants that you need. Then continue
</p>

<pre>
spack uninstall --all
spack install -j4 --only dependencies dealii
</pre>

<p>
Now we create a new spack view
</p>

<pre>
sh /path/to/spack_view.sh
</pre>

<h2>Finding info on an installed package</h2>

<pre>
$ spack find -l petsc
==> 1 installed package
-- linux-opensuse_tumbleweed20200511-broadwell / gcc@9.3.1 ------
c67eysz petsc@3.13.1
</pre>

<p>
Find more about installed petsc
</p>

<pre>
spack spec /c67eysz
</pre>

<footer> Last modified: Tue Sep 21 12:16:13 IST 2021; &copy; 2015-2020 Praveen Chandrashekar </footer> </section> </body> </html>
